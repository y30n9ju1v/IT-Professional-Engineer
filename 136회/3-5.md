## 혼동 행렬(Confusion Matrix)을 활용한 모델 성능 평가

혼동 행렬(Confusion Matrix)은 분류 모델의 성능을 평가하는 데 사용되는 표입니다. 이는 모델이 실제 값과 예측 값을 얼마나 정확하게 분류했는지를 시각적으로 보여줍니다. 주어진 혼동 행렬 결과를 바탕으로 모델의 성능을 평가하고 각 지표를 계산 및 해석합니다.

**주어진 혼동 행렬 결과:**

- True Positive (TP) = 100
    
- False Positive (FP) = 5
    
- False Negative (FN) = 7
    
- True Negative (TN) = 9
    

**총 샘플 수 (N)** = TP + FP + FN + TN = 100 + 5 + 7 + 9 = 121

### 가. 혼동 행렬을 사용한 모델의 성능 평가 원리

혼동 행렬은 분류 모델의 예측 결과와 실제 값을 비교하여 다음 네 가지 경우의 수를 표 형태로 정리한 것입니다. 이를 통해 모델이 특정 클래스에 대해 얼마나 잘 예측하고 틀리는지를 직관적으로 파악할 수 있습니다.

- **True Positive (TP)**: 실제 양성(Positive)인 것을 모델이 양성으로 **정확하게 예측**한 경우.
    
- **False Positive (FP)**: 실제 음성(Negative)인 것을 모델이 양성으로 **잘못 예측**한 경우 (제1종 오류, Type I Error).
    
- **False Negative (FN)**: 실제 양성인 것을 모델이 음성으로 **잘못 예측**한 경우 (제2종 오류, Type II Error).
    
- **True Negative (TN)**: 실제 음성인 것을 모델이 음성으로 **정확하게 예측**한 경우.
    

이 네 가지 값들을 조합하여 정확도, 정밀도, 재현율, F1-score 등 다양한 성능 지표를 계산함으로써 모델의 강점과 약점을 다각도로 평가할 수 있습니다. 예를 들어, 민감한 질병 진단 모델에서는 False Negative(실제 환자를 비환자로 오진)를 줄이는 것이 중요하므로 재현율이 핵심 지표가 되고, 스팸 메일 분류 모델에서는 False Positive(정상 메일을 스팸으로 오분류)를 줄이는 것이 중요하므로 정밀도가 강조될 수 있습니다.

### 나. 정확도, 정밀도, 재현율 계산 결과와 해석

주어진 혼동 행렬 값을 이용하여 각 지표를 계산합니다. (단, 계산 결과는 %로 표시하고 소수점은 버립니다.)

1. **정확도 (Accuracy)**
    
    - 계산: 모델이 전체 샘플 중에서 정확하게 예측한 비율입니다.
        
        Accuracy=TP+FP+FN+TNTP+TN​
        
        Accuracy=100+5+7+9100+9​=121109​≈0.9008
        
        0.9008×100=90.08%
        
    - **결과**: **90%**
        
    - **해석**: 이 모델은 전체 121개 샘플 중 약 90%를 정확하게 분류했습니다. 정확도는 전체적인 모델 성능을 나타내지만, 클래스 불균형이 심한 경우에는 오해의 소지가 있을 수 있습니다.
        
2. **정밀도 (Precision)**
    
    - 계산: 모델이 양성으로 예측한 것 중에서 실제로 양성인 비율입니다. (모델의 '정확성' 강조)
        
        Precision=TP+FPTP​
        
        Precision=100+5100​=105100​≈0.9523
        
        0.9523×100=95.23%
        
    - **결과**: **95%**
        
    - **해석**: 이 모델이 양성(Positive)이라고 예측한 105개 중 95%가 실제로 양성이었습니다. 이는 모델이 '이것은 양성이다'라고 판단했을 때, 그 판단이 틀릴 확률(FP)이 매우 낮다는 것을 의미합니다. 예를 들어, 스팸 메일 분류에서 정밀도가 높으면 정상 메일이 스팸으로 오분류되는 경우(FP)가 적습니다.
        
3. **재현율 (Recall / Sensitivity)**
    
    - 계산: 실제 양성인 것 중에서 모델이 양성으로 정확하게 예측한 비율입니다. (실제 양성을 '얼마나 잘 찾아내는가' 강조)
        
        Recall=TP+FNTP​
        
        Recall=100+7100​=107100​≈0.9345
        
        0.9345×100=93.45%
        
    - **결과**: **93%**
        
    - **해석**: 실제 양성인 107개 중 93%를 모델이 성공적으로 찾아냈습니다. 이는 모델이 실제 양성인 것을 놓칠 확률(FN)이 낮다는 것을 의미합니다. 예를 들어, 질병 진단 모델에서 재현율이 높으면 실제 환자를 놓치지 않고 잘 진단합니다.
        

### 다. F1-score 계산 결과와 해석

F1-score는 정밀도와 재현율의 조화 평균으로, 두 지표가 모두 중요한 상황에서 모델의 균형적인 성능을 평가하는 데 사용됩니다. 정밀도와 재현율 중 어느 한쪽으로 치우치지 않고 모델의 성능을 종합적으로 나타내는 지표입니다.

- 계산:
    
    F1-score=2×Precision+RecallPrecision×Recall​
    
    정밀도 (소수점): 0.9523
    
    재현율 (소수점): 0.9345
    
    F1-score=2×0.9523+0.93450.9523×0.9345​=2×1.88680.8890​=1.88681.7780​≈0.9423
    
    0.9423×100=94.23%
    
- **결과**: **94%**
    
- **해석**: 이 모델의 F1-score는 94%로, 정밀도와 재현율이 비교적 균형 있게 높은 수준임을 보여줍니다. 이는 모델이 양성 클래스를 잘 예측하면서도, 실제 양성인 샘플들을 놓치지 않고 찾아내는 능력이 모두 뛰어나다는 것을 의미합니다. F1-score는 특히 데이터 불균형이 있는 분류 문제에서 모델 성능을 평가하는 데 유용한 지표입니다.